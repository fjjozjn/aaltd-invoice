<?php

//检查purchase，如果已出完货，改状态

require(substr(__DIR__, 0, -7).'in7/global.php');

//运行脚本无时间限制
set_time_limit(0);

$purchase_rs = $mysql->q('select pcid from purchase where istatus <> ? and istatus <> ?', 'delete', '(S)');
if($purchase_rs){
	$purchase_rtn = $mysql->fetch();
	foreach($purchase_rtn as $v){
		if(checkPurchaseItemIsOut($v['pcid'])){
            $status = changePurchaseStatus($v['pcid'], '(S)');
            echo $v['pcid'].' : change status '.$status.'<br />';
        }
	}
}


/*20160927执行结果

PO00000623 : change status from (P) to (C)
PO00000875 : change status from (P) to (C)
PO00000892 : change status from (P) to (C)
PO00000893 : change status from (P) to (C)
PO00000895 : change status from (P) to (C)
PO00000896 : change status from (P) to (C)
PO00000906 : change status from (P) to (C)
PO00000908 : change status from (P) to (C)
PO00000914 : change status from (P) to (C)
PO00000965 : change status from (P) to (C)
PO00000967 : change status from (I) to (S)
PO00000970 : change status from (P) to (C)
PO00000976 : change status from (P) to (C)
PO00000982 : change status from (P) to (C)
PO00000984 : change status from (P) to (C)
PO00000990 : change status from (P) to (C)
PO00000991 : change status from (P) to (C)
PO00001020 : change status from (P) to (C)
PO00001021 : change status from (P) to (C)
PO00001025 : change status from (P) to (C)
PO00001026 : change status from (P) to (C)
PO00001027 : change status from (P) to (C)
PO00001028 : change status from (P) to (C)
PO00001029 : change status from (P) to (C)
PO00001030 : change status from (P) to (C)
PO00001031 : change status from (P) to (C)
PO00001085 : change status from (P) to (C)
PO00001097 : change status from (P) to (C)
PO00001099 : change status from (P) to (C)
PO00001100 : change status from (P) to (C)
PO00001104 : change status from (P) to (C)
PO00001128 : change status from (P) to (C)
PO00001131 : change status from (P) to (C)
PO00001151 : change status from (P) to (C)
PO00001170 : change status from (P) to (C)
PO00001180 : change status from (P) to (C)
PO00001191 : change status from (I) to (S)
PO00001196 : change status from (P) to (C)
PO00001205 : change status from (P) to (C)
PO00001206 : change status from (P) to (C)
PO00001210 : change status from (I) to (S)
PO00001224 : change status from (I) to (S)
PO00001233 : change status from (I) to (S)
PO00001239 : change status from (P) to (C)
PO00001240 : change status from (P) to (C)
PO00001241 : change status from (I) to (S)
PO00001243 : change status from (I) to (S)
PO00001244 : change status from (I) to (S)
PO00001245 : change status from (I) to (S)
PO00001251 : change status from (I) to (S)
PO00001252 : change status from (I) to (S)
PO00001254 : change status
PO00001255 : change status from (I) to (S)
PO00001259 : change status from (I) to (S)
PO00001260 : change status from (P) to (C)
PO00001262 : change status from (I) to (S)
PO00001263 : change status from (I) to (S)
PO00001264 : change status from (I) to (S)
PO00001265 : change status from (I) to (S)
PO00001266 : change status from (I) to (S)
PO00001268 : change status from (I) to (S)
PO00001269 : change status from (I) to (S)
PO00001272 : change status from (I) to (S)
PO00001275 : change status from (I) to (S)
PO00001276 : change status from (I) to (S)
PO00001279 : change status from (I) to (S)
PO00001280 : change status from (I) to (S)
PO00001282 : change status from (I) to (S)
PO00001283 : change status from (I) to (S)
PO00001284 : change status from (I) to (S)
PO00001285 : change status from (I) to (S)
PO00001287 : change status from (I) to (S)
PO00001288 : change status from (I) to (S)
PO00001289 : change status from (I) to (S)
PO00001290 : change status from (P) to (C)
PO00001292 : change status from (I) to (S)
PO00001293 : change status from (I) to (S)
PO00001294 : change status from (P) to (C)
PO00001296 : change status from (I) to (S)
PO00001297 : change status from (I) to (S)
PO00001299 : change status from (I) to (S)
PO00001308 : change status from (I) to (S)
PO00001311 : change status from (I) to (S)
PO00001312 : change status from (I) to (S)
PO00001313 : change status from (I) to (S)
PO00001316 : change status from (I) to (S)
PO00001317 : change status from (I) to (S)
PO00001318 : change status from (I) to (S)
PO00001319 : change status from (I) to (S)
PO00001320 : change status from (I) to (S)
PO00001323 : change status from (I) to (S)
PO00001324 : change status from (I) to (S)
PO00001325 : change status from (I) to (S)
PO00001326 : change status from (I) to (S)
PO00001327 : change status from (I) to (S)
PO00001329 : change status from (I) to (S)
PO00001331 : change status from (I) to (S)
PO00001332 : change status from (I) to (S)
PO00001333 : change status from (I) to (S)
PO00001334 : change status from (I) to (S)
PO00001335 : change status from (I) to (S)
PO00001336 : change status from (I) to (S)
PO00001337 : change status from (P) to (C)
PO00001339 : change status from (I) to (S)
PO00001340 : change status from (I) to (S)
PO00001341 : change status from (I) to (S)
PO00001342 : change status from (I) to (S)
PO00001343 : change status from (I) to (S)
PO00001344 : change status from (I) to (S)
PO00001345 : change status from (I) to (S)
PO00001346 : change status from (I) to (S)
PO00001352 : change status from (I) to (S)
PO00001353 : change status from (I) to (S)
PO00001354 : change status from (I) to (S)
PO00001355 : change status from (I) to (S)
PO00001356 : change status from (I) to (S)
PO00001357 : change status from (I) to (S)
PO00001358 : change status from (I) to (S)
PO00001361 : change status from (I) to (S)
PO00001362 : change status from (P) to (C)
PO00001363 : change status from (I) to (S)
PO00001364 : change status from (I) to (S)
PO00001365 : change status from (I) to (S)
PO00001366 : change status from (I) to (S)
PO00001367 : change status from (I) to (S)
PO00001370 : change status from (I) to (S)
PO00001375 : change status from (I) to (S)
PO00001376 : change status from (I) to (S)
PO00001378 : change status from (I) to (S)
PO00001379 : change status from (I) to (S)
PO00001380 : change status from (I) to (S)
PO00001381 : change status from (I) to (S)
PO00001385 : change status from (I) to (S)
PO00001386 : change status from (I) to (S)
PO00001387 : change status from (I) to (S)
PO00001388 : change status from (I) to (S)
PO00001389 : change status from (I) to (S)
PO00001390 : change status from (I) to (S)
PO00001391 : change status from (I) to (S)
PO00001392 : change status from (I) to (S)
PO00001393 : change status from (I) to (S)
PO00001394 : change status from (I) to (S)
PO00001395 : change status from (I) to (S)
PO00001396 : change status from (I) to (S)
PO00001397 : change status from (I) to (S)
PO00001399 : change status from (I) to (S)
PO00001400 : change status from (I) to (S)
PO00001401 : change status from (I) to (S)
PO00001403 : change status from (I) to (S)
PO00001404 : change status from (I) to (S)
PO00001406 : change status from (I) to (S)
PO00001408 : change status from (I) to (S)
PO00001409 : change status from (I) to (S)
PO00001410 : change status from (I) to (S)
PO00001413 : change status from (I) to (S)
PO00001415 : change status from (I) to (S)
PO00001416 : change status from (I) to (S)
PO00001417 : change status from (I) to (S)
PO00001419 : change status from (I) to (S)
PO00001420 : change status from (I) to (S)
PO00001421 : change status from (I) to (S)
PO00001423 : change status from (I) to (S)
PO00001425 : change status from (I) to (S)
PO00001426 : change status from (I) to (S)
PO00001427 : change status from (I) to (S)
PO00001428 : change status from (I) to (S)
PO00001429 : change status from (I) to (S)
PO00001430 : change status from (I) to (S)
PO00001431 : change status from (I) to (S)
PO00001432 : change status from (I) to (S)
PO00001434 : change status from (I) to (S)
PO00001435 : change status from (I) to (S)
PO00001436 : change status from (I) to (S)
PO00001437 : change status from (I) to (S)
PO00001438 : change status from (I) to (S)
PO00001439 : change status from (I) to (S)
PO00001440 : change status from (I) to (S)
PO00001441 : change status from (I) to (S)
PO00001443 : change status from (I) to (S)
PO00001445 : change status from (I) to (S)
PO00001446 : change status from (I) to (S)
PO00001447 : change status from (I) to (S)
PO00001448 : change status from (I) to (S)
PO00001449 : change status from (I) to (S)
PO00001450 : change status from (I) to (S)
PO00001451 : change status from (I) to (S)
PO00001452 : change status from (I) to (S)
PO00001453 : change status from (I) to (S)
PO00001454 : change status from (I) to (S)
PO00001455 : change status from (I) to (S)
PO00001457 : change status from (I) to (S)
PO00001458 : change status from (I) to (S)
PO00001459 : change status from (I) to (S)
PO00001460 : change status from (I) to (S)
PO00001461 : change status from (I) to (S)
PO00001463 : change status from (I) to (S)
PO00001464 : change status from (I) to (S)
PO00001465 : change status from (I) to (S)
PO00001467 : change status from (I) to (S)
PO00001468 : change status from (I) to (S)
PO00001470 : change status from (I) to (S)
PO00001471 : change status from (I) to (S)
PO00001472 : change status from (I) to (S)
PO00001473 : change status from (I) to (S)
PO00001474 : change status from (I) to (S)
PO00001475 : change status from (I) to (S)
PO00001478 : change status from (I) to (S)
PO00001479 : change status from (I) to (S)
PO00001481 : change status from (I) to (S)
PO00001482 : change status from (I) to (S)
PO00001484 : change status from (I) to (S)
PO00001487 : change status from (I) to (S)
PO00001488 : change status from (I) to (S)
PO00001489 : change status from (I) to (S)
PO00001490 : change status from (I) to (S)
PO00001492 : change status from (I) to (S)
PO00001493 : change status from (I) to (S)
PO00001494 : change status from (I) to (S)
PO00001495 : change status from (I) to (S)
PO00001496 : change status from (I) to (S)
PO00001497 : change status from (I) to (S)
PO00001498 : change status from (I) to (S)
PO00001499 : change status from (I) to (S)
PO00001500 : change status from (I) to (S)
PO00001501 : change status from (I) to (S)
PO00001502 : change status from (I) to (S)
PO00001503 : change status from (I) to (S)
PO00001505 : change status from (I) to (S)
PO00001507 : change status from (I) to (S)
PO00001508 : change status from (I) to (S)
PO00001509 : change status from (I) to (S)
PO00001510 : change status from (I) to (S)
PO00001512 : change status from (I) to (S)
PO00001513 : change status from (I) to (S)
PO00001514 : change status from (I) to (S)
PO00001515 : change status from (I) to (S)
PO00001516 : change status from (I) to (S)
PO00001517 : change status from (I) to (S)
PO00001518 : change status from (I) to (S)
PO00001519 : change status from (I) to (S)
PO00001520 : change status from (I) to (S)
PO00001521 : change status from (I) to (S)
PO00001523 : change status from (I) to (S)
PO00001524 : change status from (I) to (S)
PO00001525 : change status from (I) to (S)
PO00001526 : change status from (I) to (S)
PO00001527 : change status from (I) to (S)
PO00001528 : change status from (I) to (S)
PO00001529 : change status from (I) to (S)
PO00001530 : change status from (I) to (S)
PO00001531 : change status from (I) to (S)
PO00001532 : change status from (I) to (S)
PO00001533 : change status from (I) to (S)
PO00001534 : change status from (I) to (S)
PO00001535 : change status from (I) to (S)
PO00001536 : change status from (I) to (S)
PO00001538 : change status from (I) to (S)
PO00001539 : change status from (I) to (S)
PO00001541 : change status from (I) to (S)
PO00001542 : change status from (I) to (S)
PO00001543 : change status from (I) to (S)
PO00001544 : change status from (I) to (S)
PO00001545 : change status from (I) to (S)
PO00001546 : change status from (I) to (S)
PO00001547 : change status from (I) to (S)
PO00001548 : change status from (I) to (S)
PO00001549 : change status from (I) to (S)
PO00001551 : change status from (I) to (S)
PO00001552 : change status from (I) to (S)
PO00001553 : change status from (I) to (S)
PO00001554 : change status from (I) to (S)
PO00001556 : change status from (I) to (S)
PO00001557 : change status from (I) to (S)
PO00001558 : change status from (I) to (S)
PO00001559 : change status from (I) to (S)
PO00001560 : change status from (I) to (S)
PO00001561 : change status from (I) to (S)
PO00001562 : change status from (I) to (S)
PO00001563 : change status from (I) to (S)
PO00001564 : change status from (I) to (S)
PO00001565 : change status from (I) to (S)
PO00001566 : change status from (I) to (S)
PO00001567 : change status from (I) to (S)
PO00001569 : change status from (I) to (S)
PO00001570 : change status from (I) to (S)
PO00001572 : change status from (I) to (S)
PO00001573 : change status from (I) to (S)
PO00001574 : change status from (I) to (S)
PO00001575 : change status from (I) to (S)
PO00001576 : change status from (I) to (S)
PO00001577 : change status from (I) to (S)
PO00001579 : change status from (I) to (S)
PO00001580 : change status from (I) to (S)
PO00001581 : change status from (I) to (S)
PO00001582 : change status from (I) to (S)
PO00001583 : change status from (I) to (S)
PO00001584 : change status from (I) to (S)
PO00001585 : change status from (I) to (S)
PO00001586 : change status from (I) to (S)
PO00001587 : change status from (I) to (S)
PO00001588 : change status from (I) to (S)
PO00001589 : change status from (I) to (S)
PO00001590 : change status from (I) to (S)
PO00001591 : change status from (I) to (S)
PO00001592 : change status from (I) to (S)
PO00001593 : change status from (I) to (S)
PO00001594 : change status from (I) to (S)
PO00001595 : change status from (I) to (S)
PO00001596 : change status from (I) to (S)
PO00001597 : change status from (I) to (S)
PO00001599 : change status from (I) to (S)
PO00001600 : change status from (I) to (S)
PO00001601 : change status from (I) to (S)
PO00001602 : change status from (I) to (S)
PO00001603 : change status from (I) to (S)
PO00001604 : change status from (I) to (S)
PO00001605 : change status from (I) to (S)
PO00001606 : change status from (I) to (S)
PO00001607 : change status from (I) to (S)
PO00001608 : change status from (I) to (S)
PO00001609 : change status from (I) to (S)
PO00001610 : change status from (I) to (S)
PO00001611 : change status from (I) to (S)
PO00001612 : change status from (I) to (S)
PO00001613 : change status from (I) to (S)
PO00001614 : change status from (I) to (S)
PO00001615 : change status from (I) to (S)
PO00001616 : change status from (I) to (S)
PO00001617 : change status from (I) to (S)
PO00001618 : change status from (I) to (S)
PO00001619 : change status from (I) to (S)
PO00001620 : change status from (I) to (S)
PO00001621 : change status from (I) to (S)
PO00001622 : change status from (I) to (S)
PO00001623 : change status from (I) to (S)
PO00001624 : change status from (I) to (S)
PO00001625 : change status from (I) to (S)
PO00001626 : change status from (I) to (S)
PO00001627 : change status from (I) to (S)
PO00001628 : change status from (I) to (S)
PO00001629 : change status from (I) to (S)
PO00001630 : change status from (I) to (S)
PO00001631 : change status from (I) to (S)
PO00001632 : change status from (I) to (S)
PO00001633 : change status from (I) to (S)
PO00001635 : change status from (I) to (S)
PO00001636 : change status from (I) to (S)
PO00001637 : change status from (I) to (S)
PO00001638 : change status from (I) to (S)
PO00001639 : change status from (I) to (S)
PO00001640 : change status from (I) to (S)
PO00001641 : change status from (I) to (S)
PO00001642 : change status from (I) to (S)
PO00001643 : change status from (I) to (S)
PO00001644 : change status from (I) to (S)
PO00001645 : change status from (I) to (S)
PO00001646 : change status from (I) to (S)
PO00001647 : change status from (I) to (S)
PO00001648 : change status from (I) to (S)
PO00001649 : change status from (I) to (S)
PO00001650 : change status from (I) to (S)
PO00001651 : change status from (I) to (S)
PO00001653 : change status from (I) to (S)
PO00001654 : change status from (I) to (S)
PO00001655 : change status from (I) to (S)
PO00001656 : change status from (I) to (S)
PO00001657 : change status from (I) to (S)
PO00001658 : change status from (I) to (S)
PO00001659 : change status from (I) to (S)
PO00001664 : change status from (I) to (S)
PO00001665 : change status from (I) to (S)
PO00001666 : change status from (I) to (S)
PO00001667 : change status from (I) to (S)
PO00001668 : change status from (I) to (S)
PO00001670 : change status from (I) to (S)
PO00001671 : change status from (I) to (S)
PO00001672 : change status from (I) to (S)
PO00001673 : change status from (I) to (S)
PO00001674 : change status from (I) to (S)
PO00001675 : change status from (I) to (S)
PO00001676 : change status from (I) to (S)
PO00001677 : change status from (I) to (S)
PO00001678 : change status from (I) to (S)
PO00001679 : change status from (I) to (S)
PO00001680 : change status from (I) to (S)
PO00001681 : change status from (I) to (S)
PO00001682 : change status from (I) to (S)
PO00001683 : change status from (I) to (S)
PO00001684 : change status from (I) to (S)
PO00001685 : change status from (I) to (S)
PO00001686 : change status from (I) to (S)
PO00001687 : change status from (I) to (S)
PO00001688 : change status from (I) to (S)
PO00001689 : change status from (I) to (S)
PO00001690 : change status from (I) to (S)
PO00001691 : change status from (I) to (S)
PO00001692 : change status from (I) to (S)
PO00001693 : change status from (I) to (S)
PO00001694 : change status from (I) to (S)
PO00001695 : change status from (I) to (S)
PO00001696 : change status from (I) to (S)
PO00001697 : change status from (I) to (S)
PO00001698 : change status from (I) to (S)
PO00001699 : change status from (I) to (S)
PO00001700 : change status from (I) to (S)
PO00001701 : change status from (I) to (S)
PO00001702 : change status from (I) to (S)
PO00001703 : change status from (I) to (S)
PO00001704 : change status from (I) to (S)
PO00001705 : change status from (I) to (S)
PO00001706 : change status from (I) to (S)
PO00001707 : change status from (I) to (S)
PO00001708 : change status from (I) to (S)
PO00001709 : change status from (I) to (S)
PO00001710 : change status from (I) to (S)
PO00001711 : change status from (I) to (S)
PO00001712 : change status from (I) to (S)
PO00001716 : change status from (I) to (S)
PO00001717 : change status from (I) to (S)
PO00001718 : change status from (I) to (S)
PO00001719 : change status from (I) to (S)
PO00001721 : change status from (I) to (S)
PO00001722 : change status from (I) to (S)
PO00001723 : change status from (I) to (S)
PO00001724 : change status from (I) to (S)
PO00001725 : change status from (I) to (S)
PO00001726 : change status from (I) to (S)
PO00001727 : change status from (I) to (S)
PO00001728 : change status from (I) to (S)
PO00001729 : change status from (I) to (S)
PO00001730 : change status from (I) to (S)
PO00001731 : change status from (I) to (S)
PO00001732 : change status from (I) to (S)
PO00001733 : change status from (I) to (S)
PO00001734 : change status from (I) to (S)
PO00001735 : change status from (I) to (S)
PO00001736 : change status from (I) to (S)
PO00001739 : change status from (I) to (S)
PO00001740 : change status from (I) to (S)
PO00001741 : change status from (I) to (S)
PO00001744 : change status from (I) to (S)
PO00001745 : change status from (I) to (S)
PO00001746 : change status from (I) to (S)
PO00001747 : change status from (I) to (S)
PO00001748 : change status from (I) to (S)
PO00001750 : change status from (I) to (S)
PO00001752 : change status from (I) to (S)
PO00001753 : change status from (I) to (S)
PO00001755 : change status from (I) to (S)
PO00001756 : change status from (I) to (S)
PO00001757 : change status from (I) to (S)
PO00001759 : change status from (I) to (S)
PO00001760 : change status from (I) to (S)
PO00001761 : change status from (I) to (S)
PO00001762 : change status from (I) to (S)
PO00001763 : change status from (I) to (S)
PO00001765 : change status from (I) to (S)
PO00001766 : change status from (I) to (S)
PO00001767 : change status from (I) to (S)
PO00001768 : change status from (I) to (S)
PO00001769 : change status from (I) to (S)
PO00001770 : change status from (I) to (S)
PO00001771 : change status from (I) to (S)
PO00001772 : change status from (I) to (S)
PO00001773 : change status from (I) to (S)
PO00001774 : change status from (I) to (S)
PO00001775 : change status from (I) to (S)
PO00001776 : change status from (I) to (S)
PO00001777 : change status from (I) to (S)
PO00001778 : change status from (I) to (S)
PO00001779 : change status from (I) to (S)
PO00001780 : change status from (I) to (S)
PO00001781 : change status from (I) to (S)
PO00001782 : change status from (I) to (S)
PO00001783 : change status from (I) to (S)
PO00001784 : change status from (I) to (S)
PO00001785 : change status from (I) to (S)
PO00001786 : change status from (I) to (S)
PO00001787 : change status from (I) to (S)
PO00001788 : change status from (I) to (S)
PO00001789 : change status from (I) to (S)
PO00001790 : change status from (I) to (S)
PO00001791 : change status from (I) to (S)
PO00001792 : change status from (I) to (S)
PO00001793 : change status from (I) to (S)
PO00001794 : change status from (I) to (S)
PO00001795 : change status from (I) to (S)
PO00001796 : change status from (I) to (S)
PO00001797 : change status from (I) to (S)
PO00001798 : change status from (I) to (S)
PO00001799 : change status from (I) to (S)
PO00001800 : change status from (I) to (S)
PO00001801 : change status from (I) to (S)
PO00001802 : change status from (I) to (S)
PO00001803 : change status from (I) to (S)
PO00001804 : change status from (I) to (S)
PO00001805 : change status from (I) to (S)
PO00001807 : change status from (I) to (S)
PO00001808 : change status from (I) to (S)
PO00001812 : change status from (I) to (S)
PO00001813 : change status from (I) to (S)
PO00001814 : change status from (I) to (S)
PO00001815 : change status from (I) to (S)
PO00001816 : change status from (I) to (S)
PO00001817 : change status from (I) to (S)
PO00001818 : change status
PO00001822 : change status from (I) to (S)
PO00001823 : change status from (I) to (S)
PO00001824 : change status from (I) to (S)
PO00001828 : change status from (I) to (S)
PO00001829 : change status from (I) to (S)
PO00001830 : change status from (I) to (S)
PO00001831 : change status from (I) to (S)
PO00001832 : change status from (I) to (S)
PO00001835 : change status from (I) to (S)
PO00001836 : change status from (I) to (S)
PO00001842 : change status from (I) to (S)
PO00001844 : change status from (I) to (S)
PO00001845 : change status from (I) to (S)
PO00001847 : change status from (I) to (S)
PO00001848 : change status from (I) to (S)
PO00001850 : change status from (I) to (S)
PO00001854 : change status from (I) to (S)
PO00001857 : change status from (I) to (S)
PO00001858 : change status from (I) to (S)
PO00001859 : change status from (I) to (S)
PO00001863 : change status from (I) to (S)
PO00001867 : change status from (I) to (S)


*/